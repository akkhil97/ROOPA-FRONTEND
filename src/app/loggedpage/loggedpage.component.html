<div *ngIf="isLoggedOut" class="logout-message-container">
  <div class="logout-message-box">
    <h2>You have been logged out</h2>
    <p>Please login again to continue.</p>
    <button routerLink="/login">Go to Login Page</button>
  </div>
</div>

<div  *ngIf="!isLoggedOut" class="app-container">
  <div class="content">

    <div class="toggle-bar">
      <button [class.active]="activeTab === 'notices'" (click)="activeTab = 'notices'">ğŸ“¢ Notices</button>
      <button [class.active]="activeTab === 'photos'" (click)="activeTab = 'photos'">ğŸ“¸ Photos</button>
    </div>

    <!-- Notices Section -->
    <section *ngIf="activeTab === 'notices'">
      <div class="card">
        <h2>ğŸ“Œ Post / Update Notice</h2>
        <input type="text" placeholder="Notice Title" [(ngModel)]="form.title" />
        <textarea placeholder="Notice Description" [(ngModel)]="form.description"></textarea>
        <input type="date" [(ngModel)]="form.postedDate" />
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
          <button (click)="saveNotice()">{{ form.id ? 'Update' : 'Post' }}</button>
          <button *ngIf="form.id" type="button" (click)="resetForm()">Cancel</button>
        </div>
      </div>

      <div class="card">
        <h2>ğŸ“„ Existing Notices</h2>
        <ul style="list-style: none; padding: 0;">
          <li *ngFor="let notice of notices" class="notice-item">
            <div class="notice-content">
              <div class="notice-title">{{ notice.title }}</div>
              <div class="notice-description">{{ notice.description }}</div>
              <div class="notice-date">ğŸ“… {{ notice.postedDateTime | date: 'yyyy-MM-dd' }}</div>
            </div>
            <div class="notice-actions">
              <button (click)="editNotice(notice)">Edit</button>
              <button (click)="deleteNotice(notice.id)">Delete</button>
            </div>
          </li>
        </ul>
      </div>
    </section>

    <!-- Photos Section -->
    <section *ngIf="activeTab === 'photos'">
      <div class="card">
        <h2>ğŸ“¸ Post Photos</h2>
        <input type="text" placeholder="Photo Title" [(ngModel)]="photoForm.title" />
        <input type="date" [(ngModel)]="photoForm.postedDate" />
        <input type="file" (change)="onFileSelected($event)" multiple accept="image/*" />
        <div class="file-info">
          Selected: {{ selectedFiles.length }} / 20 photos max
        </div>
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
          <button (click)="uploadPhotos()" [disabled]="selectedFiles.length === 0 || selectedFiles.length > 20">
            Upload Photos
          </button>
          <button *ngIf="photoForm.id" (click)="updatePhoto()" [disabled]="selectedFiles.length === 0 || selectedFiles.length > 20">
            Update Photos
          </button>
          <button *ngIf="photoForm.id" (click)="resetPhotoForm()">Cancel</button>
        </div>
      </div>

      <div class="card">
        <h2>ğŸ“ Existing Photo Sets</h2>
        <div *ngFor="let item of galleryItems" class="photo-set">
          <h3>{{ item.title }} ({{ item.postedDate }})</h3>
          <div class="gallery-grid">
            <div *ngFor="let photo of item.photos" class="gallery-item" (click)="openGallery(item)">
              <img [src]="photo" [alt]="item.title" class="gallery-image" />
            </div>
          </div>
          <div style="display: flex; gap: 10px; margin-top: 5px;">
            <button (click)="editPhoto(item)">Edit Set</button>
            <button (click)="deletePhoto(item.id)">ğŸ—‘ï¸ Delete Set</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal Gallery -->
    <div class="modal-fullscreen" *ngIf="showModal" (click)="closeGallery()">
      <div class="modal-gallery-content" (click)="$event.stopPropagation()">
        <h2 class="modal-title">{{ selectedItem?.title }}</h2>
        <div class="modal-gallery-image-container">
          <button class="arrow-button left" (click)="prevImage($event)">â—€ï¸</button>
          <img [src]="selectedItem?.photos[currentPhotoIndex]" alt="Gallery Photo" class="modal-gallery-image" />
          <button class="arrow-button right" (click)="nextImage($event)">â–¶ï¸</button>
        </div>
        <div class="modal-controls">
          <!-- <button (click)="downloadImage(selectedItem?.photos[currentPhotoIndex])">â¬‡ï¸ Download</button> -->
          <span class="photo-counter">{{ currentPhotoIndex + 1 }} / {{ selectedItem?.photos.length }}</span>
        </div>
      </div>
    </div>

  </div>
</div>


